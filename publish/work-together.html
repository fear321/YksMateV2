<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YKSMate - Birlikte Çalışma</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/theme-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="assets/images/logo(192).png">
    
    <style>
        /* Birlikte Çalışma Sayfası Özel Stilleri */
        .work-together-container {
            max-height: 100%;
            display: flex;
            flex-direction: column;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        /* Yeni iki sütunlu düzen */
        .work-together-layout {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        
        @media (min-width: 768px) {
            .work-together-layout {
                flex-direction: row;
            }
            
            .create-room-container {
                width: 60%;
                margin-right: 20px;
            }
            
            .room-list-container {
                width: 40%;
            }
        }
        
        .create-room-container,
        .room-list-container {
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        .section-title {
            margin-top: 0;
            margin-bottom: 20px;
            font-size: 1.5rem;
            color: #333;
            border-bottom: 2px solid rgb(75, 33, 56);
            padding-bottom: 10px;
        }
        
        /* Oda kartları */
        .active-rooms {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .room-card {
            background-color: #f9f9f9;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .room-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        
        .room-info {
            flex: 1;
            margin-bottom: 15px;
        }
        
        .room-name {
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.2rem;
            color: #333;
        }
        
        .room-creator {
            margin: 0 0 10px 0;
            font-size: 0.85rem;
            color: #555;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .room-creator i {
            color: #f39c12;
            font-size: 0.9rem;
        }
        
        .room-details {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            color: #666;
            margin: 0;
        }
        
        .mode {
            background-color: #e9f0fe;
            padding: 3px 8px;
            border-radius: 4px;
            color: rgb(75, 33, 56);
        }
        
        .participant-count {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .join-room-btn {
            width: 100%;
            padding: 8px 0;
            background-color: rgb(75, 33, 56);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-weight: 500;
        }
        
        .join-room-btn:hover {
            background-color: rgba(75, 33, 56, 0.8);
        }
        
        .no-rooms {
            text-align: center;
            color: #666;
            padding: 20px;
            font-style: italic;
        }
        
        /* Form stilleri */
        .room-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .form-group label {
            font-weight: 500;
            font-size: 0.9rem;
            color: #555;
        }
        
        .form-control {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Poppins', sans-serif;
            transition: border-color 0.2s;
        }
        
        .form-control:focus {
            border-color: rgb(75, 33, 56);
            outline: none;
        }
        
        .create-room-btn {
            padding: 12px;
            background-color: rgb(75, 33, 56);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            margin-top: 10px;
            transition: background-color 0.2s;
        }
        
        .create-room-btn:hover {
            background-color: rgba(75, 33, 56, 0.8);
        }
        
        /* Eski stilleri koru */
        .room-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #eee;
            background-color: #f9f9f9;
            border-radius: 10px 10px 0 0;
        }
        
        .room-header h3 {
            margin: 0;
            font-size: 1.2rem;
            color: #333;
        }
        
        .room-header-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .leave-room-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            font-size: 14px;
            font-weight: 600;
            background-color: #dc3545;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s ease;
            animation: pulse-red 2s infinite;
        }
        
        .leave-room-btn:hover {
            background-color: #c82333;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            animation: none;
        }
        
        @keyframes pulse-red {
            0% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(220, 53, 69, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(220, 53, 69, 0);
            }
        }
        
        .room-content {
            display: flex;
            height: 70vh;
            background-color: #fff;
        }
        
        /* Sol panel (timer ve kullanıcılar) */
        .left-panel {
            width: 70%;
            border-right: 1px solid #eee;
            padding: 15px;
            display: flex;
            flex-direction: column;
        }
        
        .timer-container {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px 0;
            border-bottom: 1px solid #eee;
            background-color: #f9f9f9;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }
        
        .timer-container h4 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #333;
            font-weight: 600;
        }
        
        .timer-display {
            font-size: 4.5rem;
            font-weight: bold;
            margin: 20px 0;
            color: rgb(75, 33, 56) !important;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .timer-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }
        
        .timer-controls button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background-color: rgb(75, 33, 56);
            color: white;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .timer-controls button:hover {
            background-color: rgba(75, 33, 56, 0.8);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .timer-controls button i {
            margin-right: 8px;
        }
        
        .users-container {
            flex: 1;
            overflow-y: auto;
        }
        
        /* Kullanıcı listesini grid yapısına çevir */
        #usersList {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        /* Mobil görünüm için düzenleme */
        @media (max-width: 768px) {
            #usersList {
                grid-template-columns: 1fr;
            }
            
            .left-panel {
                width: 100%;
                border-right: none;
            }
            
            .room-content {
                flex-direction: column;
                height: auto;
            }
            
            .chat-panel {
                height: 300px;
            }
        }
        
        .user-item {
            display: flex;
            align-items: center;
            margin-bottom: 0;
            padding: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .user-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            color: var(--sidebar-text);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        
        .user-info {
            flex: 1;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .user-name {
            font-weight: 600;
            margin: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .user-status {
            font-size: 0.8rem;
            color: #6c757d;
            margin: 0;
        }
        
        /* Sağ panel (sohbet) */
        .chat-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: #f9f9f9;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            max-height: 250px;
        }
        
        .message {
            margin-bottom: 15px;
            max-width: 80%;
        }
        
        .message-sender {
            font-weight: 600;
            margin-bottom: 3px;
            font-size: 0.9rem;
        }
        
        .message-content {
            padding: 10px;
            border-radius: 10px;
            background-color: #e9ecef;
            display: inline-block;
        }
        
        .message.own-message {
            margin-left: auto;
            text-align: right;
        }
        
        .message.own-message .message-content {
            background-color: rgb(75, 33, 56);
            color: white;
        }
        
        .message-time {
            font-size: 0.7rem;
            color: #6c757d;
            margin-top: 3px;
        }
        
        .chat-input-container {
            padding: 15px;
            border-top: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        
        .chat-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 20px;
            margin-right: 10px;
        }
        
        .chat-send-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: rgb(75, 33, 56);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }
        
        .chat-send-btn:hover {
            background-color: rgba(75, 33, 56, 0.8);
        }
        
        /* Oda oluşturma ve katılma */
        .create-room-container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 5px;
        }
        
        .btn-primary {
            background-color: rgb(75, 33, 56);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .btn-primary:hover {
            background-color: rgba(75, 33, 56, 0.8);
        }
        
        .room-item {
            padding: 15px;
            background-color: #fff;
            border-radius: 5px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .room-info h4 {
            margin: 0 0 5px 0;
        }
        
        .room-meta {
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .room-mode {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            margin-right: 10px;
        }
        
        .mode-pomodoro {
            background-color: #f44336;
            color: white;
        }
        
        .mode-free {
            background-color: #4caf50;
            color: white;
        }
        
        .mode-exam {
            background-color: #2196f3;
            color: white;
        }
        
        /* Karanlık tema uyumluluğu */
        .dark-theme .work-together-container,
        .dark-theme .create-room-container,
        .dark-theme .room-item {
            background-color: #2a2a2a;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .dark-theme .room-header,
        .dark-theme .chat-input-container {
            background-color: #333;
            border-color: #444;
        }
        
        .dark-theme .room-header h3 {
            color: #eee;
        }
        
        .dark-theme .left-panel {
            border-color: #444;
            background-color: #2a2a2a;
        }
        
        .dark-theme .timer-container {
            background-color: #333;
            border-color: #444;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .dark-theme .timer-display {
            color: rgb(75, 33, 56) !important;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .dark-theme .timer-controls button {
            background-color: rgb(75, 33, 56);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        .dark-theme .timer-controls button:hover {
            background-color: rgba(75, 33, 56, 0.8);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }
        
        .dark-theme .users-container {
            background-color: #333;
        }
        
        .dark-theme .leave-room-btn {
            background-color: #e35d6a;
            color: white;
        }
        
        .dark-theme .leave-room-btn:hover {
            background-color: #dc3545;
        }
        
        .dark-theme .user-item {
            background-color: #333;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }
        
        .dark-theme .user-item:hover {
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .dark-theme .chat-panel {
            background-color: #333;
        }
        
        .dark-theme .message-content {
            background-color: #444;
            color: #eee;
        }
        
        .dark-theme .chat-input {
            background-color: #333;
            border-color: #555;
            color: #eee;
        }
        
        .dark-theme .form-control {
            background-color: #333;
            border-color: #555;
            color: #eee;
        }
        
        .dark-theme .room-meta {
            color: #aaa;
        }
        
        .dark-theme .timer-container h4 {
            color: #eee;
        }
        
        .dark-theme .user-avatar {
            background-color: rgb(75, 33, 56);
        }
        
        .dark-theme .message.own-message .message-content {
            background-color: rgb(75, 33, 56);
            color: white;
        }
        
        .dark-theme .chat-send-btn {
            background-color: rgb(75, 33, 56);
        }
        
        .dark-theme .chat-send-btn:hover {
            background-color: rgba(75, 33, 56, 0.8);
        }
        
        .dark-theme .btn-primary {
            background-color: rgb(75, 33, 56);
        }
        
        .dark-theme .btn-primary:hover {
            background-color: rgba(75, 33, 56, 0.8);
        }
        
        .dark-theme .section-title {
            border-bottom-color: rgb(75, 33, 56);
        }
        
        .dark-theme .mode {
            color: rgb(75, 33, 56);
        }

        /* Tam ekran modu için CSS */
        .timer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .timer-header h4 {
            margin: 0;
        }

        .fullscreen-btn {
            background: transparent;
            border: none;
            color: inherit;
            font-size: 1.2rem;
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .fullscreen-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .dark-theme .fullscreen-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .timer-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999;
            background-color: rgba(255, 255, 255, 0.95);
            display: flex;
            flex-direction: row;
            padding: 20px;
            overflow: hidden;
        }

        .dark-theme .timer-fullscreen {
            background-color: rgba(10, 10, 10, 0.95);
        }

        .timer-fullscreen-content {
            display: flex;
            flex-direction: column;
            width: calc(100% - 400px);
            height: 100%;
            padding-right: 20px;
            overflow-y: auto;
        }

        .timer-fullscreen-top {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .timer-fullscreen .timer-display {
            font-size: 8rem;
            margin: 20px 0;
            text-align: center;
            color: rgb(75, 33, 56);
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .dark-theme .timer-fullscreen .timer-display {
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .timer-fullscreen .timer-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .timer-fullscreen-participants {
            flex: 1;
            overflow-y: auto;
            background-color: rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            padding: 15px;
        }

        .dark-theme .timer-fullscreen-participants {
            background-color: rgba(50, 50, 50, 0.5);
        }

        #fullscreenUsersList {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        @media (max-width: 1200px) {
            #fullscreenUsersList {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        .fullscreen-exit {
            position: absolute;
            top: 20px;
            right: 440px;
            z-index: 10000;
            background-color: rgba(0, 0, 0, 0.1);
            color: #333;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .fullscreen-exit:hover {
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .dark-theme .fullscreen-exit {
            background-color: rgba(255, 255, 255, 0.1);
            color: #eee;
        }
        
        .dark-theme .fullscreen-exit:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        .fullscreen-chat {
            width: 400px;
            height: 100%;
            display: flex;
            flex-direction: column;
            position: absolute;
            right: 0;
            top: 0;
            background-color: rgba(255, 255, 255, 0.8);
            border-left: 1px solid rgba(0, 0, 0, 0.1);
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .dark-theme .fullscreen-chat {
            background-color: rgba(20, 20, 20, 0.8);
            border-left: 1px solid rgba(255, 255, 255, 0.1);
        }

        .fullscreen-chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            max-height: calc(100% - 120px);
        }

        .dark-theme .fullscreen-chat-messages {
            background-color: rgba(255, 255, 255, 0.05);
        }

        .fullscreen-chat-input {
            display: flex;
            gap: 10px;
            margin-top: auto;
            padding-top: 10px;
        }
        
        .fullscreen-chat-input input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #ced4da;
            border-radius: 20px;
        }

        .dark-theme .fullscreen-chat-input input {
            background-color: #333;
            border-color: #555;
            color: #eee;
        }

        .timer-fullscreen-center {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .timer-fullscreen .timer-header {
            width: 100%;
            max-width: 600px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .fullscreen-exit {
            position: absolute;
            top: 20px;
            right: 440px;
            z-index: 10000;
            background-color: rgba(0, 0, 0, 0.1);
            color: #333;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }
        
        .fullscreen-exit:hover {
            background-color: rgba(0, 0, 0, 0.2);
        }
        
        .dark-theme .fullscreen-exit {
            background-color: rgba(255, 255, 255, 0.1);
            color: #eee;
        }
        
        .dark-theme .fullscreen-exit:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        /* Bildirim stilleri güncellendi */
        .notification-container {
            position: fixed !important;
            top: 20px !important;
            right: 20px !important;  
            left: auto !important;
            bottom: auto !important;
            z-index: 10001 !important;
            width: auto !important;
            max-width: 350px !important;
            display: flex !important;
            flex-direction: column !important;
            gap: 10px !important;
            pointer-events: none !important;
            transform: none !important;
        }
        
        .timer-notification {
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: fadeInOut 5s forwards;
            font-size: 14px;
            text-align: center;
            pointer-events: none;
        }
        
        .dark-theme .timer-notification {
            background-color: rgba(255, 255, 255, 0.15) !important;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(20px); }
            10% { opacity: 1; transform: translateY(0); }
            90% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-20px); }
        }

        /* Responsive fullscreen layout */
        @media (max-width: 1000px) {
            .timer-fullscreen {
                flex-direction: column;
                overflow: hidden;
            }
            
            .timer-fullscreen-content {
                width: 100%;
                padding-right: 0;
                height: 65%;
                overflow-y: auto;
            }
            
            .fullscreen-chat {
                width: 100%;
                height: 35%;
                position: relative;
                right: 0;
                top: 0;
                border-left: none;
                border-top: 1px solid rgba(0, 0, 0, 0.1);
                overflow-y: auto;
            }
            
            .fullscreen-exit {
                right: 20px;
            }
            
            .timer-fullscreen-top {
                min-height: 400px;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }
            
            .timer-fullscreen-participants {
                display: none;
            }

            .fullscreen-chat-messages {
                max-height: 150px;
            }

            .timer-fullscreen .timer-display {
                font-size: 6rem;
            }
        }

        @media (max-width: 1000px) {
            .dark-theme .fullscreen-chat {
                border-left: none;
                border-top: 1px solid rgba(255, 255, 255, 0.1);
            }
        }
    </style>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <!-- Ana JavaScript -->
    <script src="js/firebase-config.js"></script>
    <script src="js/auth-check.js"></script>
    <script src="js/theme-manager.js"></script>
    <script src="js/app.js"></script>
    <script src="js/user-token-display.js"></script>
    <script src="js/work-together.js"></script>

</head>
<body class="light-theme">
    <div class="container">
        <!-- Ana Dashboard -->
        <div class="dashboard-container" id="dashboardContainer">
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="user-info">
                    <div class="user-avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-details">
                        <a href="profile.html" style="text-decoration: none; color: inherit;">
                            <h3 id="userName">Kullanıcı Adı</h3>
                            <p id="userExamType"></p>
                        </a>
                    </div>
                </div>
                <nav class="sidebar-nav">
                    <ul>
                        <li>
                            <a href="index.html"><i class="fas fa-home"></i> Ana Sayfa</a>
                        </li>
                        <li>
                            <a href="exams.html"><i class="fas fa-file-alt"></i> Denemelerim</a>
                        </li>
                        <li>
                            <a href="timer.html"><i class="fas fa-clock"></i> Zamanlayıcı</a>
                        </li>
                        <li>
                            <a href="calendar.html"><i class="fas fa-calendar-alt"></i> Takvim</a>
                        </li>
                        <li>
                            <a href="notes.html"><i class="fas fa-sticky-note"></i> Notlarım</a>
                        </li>
                        <li>
                            <a href="community.html"><i class="fas fa-users"></i> Topluluk</a>
                        </li>
                        <li>
                            <a href="friends.html"><i class="fas fa-user-friends"></i> Arkadaşlarım</a>
                        </li>
                        <li>
                            <a href="messages.html"><i class="fas fa-comment"></i> Mesajlar</a>
                        </li>
                        <li>
                            <a href="ai.html"><i class="fas fa-robot"></i> MateAI</a>
                        </li>
                        <li class="active">
                            <a href="work-together.html"><i class="fas fa-users-cog"></i> Birlikte Çalış</a>
                        </li>
                        <li>
                            <a href="profile.html"><i class="fas fa-user-circle"></i> Profil</a>
                        </li>
                        <li>
                            <a href="settings.html"><i class="fas fa-cog"></i> Ayarlar</a>
                        </li>
                    </ul>
                </nav>
                <div class="sidebar-footer">

                </div>
            </div>

            <!-- Sidebar Overlay -->
            <div class="sidebar-overlay"></div>

            <!-- Ana İçerik -->
            <div class="main-content">
                <header class="content-header">
                    <button id="sidebarToggle" class="sidebar-toggle">
                        <i class="fas fa-bars"></i>
                    </button>
                    <div class="header-actions">
                        <button class="theme-toggle" id="themeToggle">
                            <i class="fas fa-moon"></i>
                        </button>
                        <div class="notifications">
                            <button class="notification-btn">
                                <i class="fas fa-bell"></i>
                                <span class="notification-badge">3</span>
                            </button>
                        </div>
                    </div>
                </header>

                <!-- Sayfa İçeriği -->
                <div class="page-content">
                    <h1 class="page-title">Birlikte Çalışma</h1>
                    
                    <!-- Birlikte Çalışma İçeriği -->
                    <!-- İki sütunlu düzen için layout -->
                    <div class="work-together-layout">
                        <!-- Oda Oluşturma Formu -->
                        <div class="create-room-container" id="createRoomContainer">
                            <h2 class="section-title">Yeni Çalışma Odası Oluştur</h2>
                            <form id="createRoomForm" class="room-form">
                                <div class="form-group">
                                    <label for="roomName">Oda Adı</label>
                                    <input type="text" id="roomName" class="form-control" placeholder="Oda adını girin" required>
                                </div>
                                
                                <div class="form-group">
                                    <label for="roomMode">Çalışma Modu</label>
                                    <select id="roomMode" class="form-control" required>
                                        <option value="pomodoro">Pomodoro (25dk çalışma + 5dk mola)</option>
                                        <option value="free">Serbest Çalışma</option>
                                        <option value="exam">Deneme Sınavı Modu</option>
                                    </select>
                                </div>
                                
                                <div class="form-group" id="examDurationContainer" style="display:none;">
                                    <label for="examDuration">Sınav Süresi (dakika)</label>
                                    <input type="number" id="examDuration" class="form-control" value="135" min="30" max="180">
                                </div>
                                
                                <div class="form-group">
                                    <label for="roomVisibility">Oda Görünürlüğü</label>
                                    <select id="roomVisibility" class="form-control" required>
                                        <option value="public">Herkese Açık</option>
                                        <option value="private">Sadece Davet İle</option>
                                    </select>
                                </div>
                                
                                <button type="submit" class="create-room-btn">Oda Oluştur</button>
                            </form>
                        </div>
                        
                        <!-- Aktif Odalar Listesi -->
                        <div class="room-list-container" id="roomListContainer">
                            <h2 class="section-title">Aktif Çalışma Odaları</h2>
                            <div id="activeRooms" class="active-rooms">
                                <div class="loading-rooms">
                                    <i class="fas fa-spinner fa-spin"></i> Odalar yükleniyor...
                                </div>
                                <!-- Odalar dinamik olarak buraya eklenecek -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Çalışma Odası (Başlangıçta Gizli) -->
                    <div class="work-together-container" id="workTogetherContainer" style="display:none;">
                        <div class="room-header">
                            <h3 id="roomTitle">Oda Adı</h3>
                            <div class="room-header-buttons">
                                <button class="leave-room-btn" id="leaveRoomBtn">
                                    <i class="fas fa-sign-out-alt"></i> Ayrıl
                                </button>
                            </div>
                        </div>
                        
                        <div class="room-content">
                            <!-- Sol Panel (Timer ve Kullanıcılar) -->
                            <div class="left-panel">
                                <div class="timer-container">
                                    <div class="timer-header">
                                        <h4>Zamanlayıcı</h4>
                                        <button id="fullscreenTimerBtn" class="fullscreen-btn">
                                            <i class="fas fa-expand"></i>
                                        </button>
                                    </div>
                                    <div class="timer-display" id="timerDisplay">25:00</div>
                                    <div class="timer-controls">
                                        <button id="startTimerBtn"><i class="fas fa-play"></i> Başlat</button>
                                        <button id="resetTimerBtn"><i class="fas fa-redo"></i> Sıfırla</button>
                                    </div>
                                </div>
                                
                                <div class="users-container">
                                    <h4>Katılımcılar (<span id="userCount">0</span>)</h4>
                                    <div id="usersList">
                                        <!-- Kullanıcılar dinamik olarak buraya eklenecek -->
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Sağ Panel (Sohbet) -->
                            <div class="chat-panel">
                                <div class="chat-messages" id="chatMessages">
                                    <!-- Mesajlar dinamik olarak buraya eklenecek -->
                                </div>
                                
                                <div class="chat-input-container">
                                    <input type="text" class="chat-input" id="chatInput" placeholder="Mesajınızı yazın...">
                                    <button class="chat-send-btn" id="chatSendBtn">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Sınav modu seçildiğinde süre ayarını göster
            const roomModeSelect = document.getElementById('roomMode');
            const examDurationContainer = document.getElementById('examDurationContainer');
            
            roomModeSelect.addEventListener('change', function() {
                if (this.value === 'exam') {
                    examDurationContainer.style.display = 'block';
                } else {
                    examDurationContainer.style.display = 'none';
                }
            });

            // Tam ekran modu için gerekli kodlar
            const fullscreenTimerBtn = document.getElementById('fullscreenTimerBtn');
            const timerDisplay = document.getElementById('timerDisplay');
            const startTimerBtn = document.getElementById('startTimerBtn');
            const resetTimerBtn = document.getElementById('resetTimerBtn');
            const chatMessages = document.getElementById('chatMessages');
            const chatInput = document.getElementById('chatInput');
            const chatSendBtn = document.getElementById('chatSendBtn');
            
            let isFullscreen = false;
            let fullscreenContainer = null;
            let fullscreenChatMessages = null;
            let fullscreenChatInput = null;
            let fullscreenChatSendBtn = null;
            
            // Tam ekran modunu açıp kapatan fonksiyon
            fullscreenTimerBtn.addEventListener('click', function() {
                if (!isFullscreen) {
                    // Tam ekran modunu aç
                    openFullscreenMode();
                } else {
                    // Tam ekran modundan çık
                    closeFullscreenMode();
                }
            });
            
            // Tam ekran modunu açan fonksiyon
            function openFullscreenMode() {
                isFullscreen = true;
                
                // Tam ekran container oluştur
                fullscreenContainer = document.createElement('div');
                fullscreenContainer.className = 'timer-fullscreen';
                
                // Çıkış butonu oluştur
                const exitButton = document.createElement('button');
                exitButton.className = 'fullscreen-exit';
                exitButton.innerHTML = '<i class="fas fa-times"></i>';
                exitButton.addEventListener('click', closeFullscreenMode);
                
                // Sol kısım için ana container
                const timerContentContainer = document.createElement('div');
                timerContentContainer.className = 'timer-fullscreen-content';
                
                // Üst kısım - timer ve kontroller
                const timerTopContainer = document.createElement('div');
                timerTopContainer.className = 'timer-fullscreen-top';
                
                // Timer header bölümünü ekle
                const timerHeader = document.createElement('div');
                timerHeader.className = 'timer-header';
                
                const headerTitle = document.createElement('h4');
                headerTitle.textContent = 'Zamanlayıcı';
                
                timerHeader.appendChild(headerTitle);
                
                // Timer display ve kontrolleri ekle
                const timerDisplayClone = document.createElement('div');
                timerDisplayClone.className = 'timer-display';
                timerDisplayClone.id = 'fullscreenTimerDisplay';
                timerDisplayClone.textContent = timerDisplay.textContent;
                
                const timerControls = document.createElement('div');
                timerControls.className = 'timer-controls';
                
                const startBtnClone = startTimerBtn.cloneNode(true);
                startBtnClone.id = 'fullscreenStartBtn';
                
                const resetBtnClone = resetTimerBtn.cloneNode(true);
                resetBtnClone.id = 'fullscreenResetBtn';
                
                timerControls.appendChild(startBtnClone);
                timerControls.appendChild(resetBtnClone);
                
                // Timer üst kısmını tamamla
                timerTopContainer.appendChild(timerHeader);
                timerTopContainer.appendChild(timerDisplayClone);
                timerTopContainer.appendChild(timerControls);
                
                // Alt kısım - katılımcılar
                const participantsContainer = document.createElement('div');
                participantsContainer.className = 'timer-fullscreen-participants';
                
                const participantsHeader = document.createElement('h4');
                participantsHeader.textContent = 'Katılımcılar';
                participantsHeader.style.marginTop = '0';
                participantsHeader.style.marginBottom = '15px';
                
                const fullscreenUsersList = document.createElement('div');
                fullscreenUsersList.id = 'fullscreenUsersList';
                
                // Mevcut kullanıcı listesini kopyala
                if (document.getElementById('usersList')) {
                    fullscreenUsersList.innerHTML = document.getElementById('usersList').innerHTML;
                }
                
                participantsContainer.appendChild(participantsHeader);
                participantsContainer.appendChild(fullscreenUsersList);
                
                // Sol kısımı tamamla
                timerContentContainer.appendChild(timerTopContainer);
                timerContentContainer.appendChild(participantsContainer);
                
                // Sağ tarafta sohbet bölümünü ekle
                const fullscreenChat = document.createElement('div');
                fullscreenChat.className = 'fullscreen-chat';
                
                const chatHeader = document.createElement('h4');
                chatHeader.textContent = 'Sohbet';
                chatHeader.style.marginTop = '0';
                chatHeader.style.marginBottom = '15px';
                
                fullscreenChatMessages = document.createElement('div');
                fullscreenChatMessages.className = 'fullscreen-chat-messages';
                
                const chatInputContainer = document.createElement('div');
                chatInputContainer.className = 'fullscreen-chat-input';
                
                fullscreenChatInput = document.createElement('input');
                fullscreenChatInput.type = 'text';
                fullscreenChatInput.placeholder = 'Mesajınızı yazın...';
                
                fullscreenChatSendBtn = document.createElement('button');
                fullscreenChatSendBtn.className = 'chat-send-btn';
                fullscreenChatSendBtn.innerHTML = '<i class="fas fa-paper-plane"></i>';
                
                chatInputContainer.appendChild(fullscreenChatInput);
                chatInputContainer.appendChild(fullscreenChatSendBtn);
                
                fullscreenChat.appendChild(chatHeader);
                fullscreenChat.appendChild(fullscreenChatMessages);
                fullscreenChat.appendChild(chatInputContainer);
                
                // Tam ekran container'a elemanları ekleme
                document.body.appendChild(fullscreenContainer);
                fullscreenContainer.appendChild(exitButton);
                fullscreenContainer.appendChild(timerContentContainer);
                fullscreenContainer.appendChild(fullscreenChat);
                
                // Mevcut sohbet mesajlarını kopyala
                fullscreenChatMessages.innerHTML = chatMessages.innerHTML;
                
                // Kullanıcı listesini sürekli güncelle
                const userListObserver = new MutationObserver(function(mutations) {
                    if (isFullscreen && fullscreenUsersList) {
                        fullscreenUsersList.innerHTML = document.getElementById('usersList').innerHTML;
                    }
                });
                
                if (document.getElementById('usersList')) {
                    userListObserver.observe(document.getElementById('usersList'), { childList: true, subtree: true });
                }
                
                // Butonlara event listener ekle
                startBtnClone.addEventListener('click', function() {
                    // Orijinal butonu tetikle ve bildirim göster
                    startTimerBtn.click();
                });
                
                resetBtnClone.addEventListener('click', function() {
                    // Orijinal butonu tetikle ve bildirim göster
                    resetTimerBtn.click();
                });
                
                fullscreenChatSendBtn.addEventListener('click', sendFullscreenMessage);
                fullscreenChatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendFullscreenMessage();
                    }
                });
                
                // Tam ekran butonun ikonunu değiştir
                fullscreenTimerBtn.innerHTML = '<i class="fas fa-compress"></i>';
                
                // Tema kontrolü - eğer karanlık tema aktifse tam ekrana da uygula
                if (document.body.classList.contains('dark-theme')) {
                    fullscreenContainer.classList.add('dark-theme');
                }
                
                // Input'a odaklanma
                fullscreenChatInput.focus();
            }
            
            // Tam ekran modundan çıkan fonksiyon
            function closeFullscreenMode() {
                if (fullscreenContainer) {
                    // Container'ı kaldır
                    document.body.removeChild(fullscreenContainer);
                    fullscreenContainer = null;
                    
                    // Butonu eski haline getir
                    fullscreenTimerBtn.innerHTML = '<i class="fas fa-expand"></i>';
                    
                    isFullscreen = false;
                }
            }
            
            // Tam ekranda mesaj gönderme fonksiyonu
            function sendFullscreenMessage() {
                const message = fullscreenChatInput.value.trim();
                if (message) {
                    // Hem tam ekran chat hem de normal chat'e mesajı ekle
                    const messageElement = createChatMessageElement(message, true);
                    chatMessages.appendChild(messageElement.cloneNode(true));
                    
                    // Tam ekran chat'e de ekle
                    if (fullscreenChatMessages) {
                        fullscreenChatMessages.appendChild(messageElement);
                        fullscreenChatMessages.scrollTop = fullscreenChatMessages.scrollHeight;
                    }
                    
                    // İnputu temizle
                    fullscreenChatInput.value = '';
                    
                    // Bu noktada sunucuya mesaj gönderme işlemi yapılmalı
                    // Bu örnek için sadece frontend gösterimi yapıyoruz
                }
            }
            
            // Normal mesaj değişikliklerini tam ekrana yansıtma
            const observer = new MutationObserver(function(mutations) {
                if (isFullscreen && fullscreenChatMessages) {
                    fullscreenChatMessages.innerHTML = chatMessages.innerHTML;
                    fullscreenChatMessages.scrollTop = fullscreenChatMessages.scrollHeight;
                }
            });
            
            observer.observe(chatMessages, { childList: true });
            
            // Timer değişikliklerini tam ekrana yansıtma
            setInterval(function() {
                if (isFullscreen) {
                    const fullscreenTimer = document.getElementById('fullscreenTimerDisplay');
                    if (fullscreenTimer) {
                        fullscreenTimer.textContent = timerDisplay.textContent;
                    }
                }
            }, 1000);
            
            // Mesaj elemanı oluşturma fonksiyonu
            function createChatMessageElement(message, isOwn = false) {
                const currentTime = new Date();
                const hours = currentTime.getHours().toString().padStart(2, '0');
                const minutes = currentTime.getMinutes().toString().padStart(2, '0');
                const timeString = `${hours}:${minutes}`;
                
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${isOwn ? 'own-message' : ''}`;
                
                // Kullanıcı adı bilgisi gerçek uygulamada dinamik olacaktır
                const senderName = isOwn ? 'Ben' : 'Diğer Kullanıcı';
                
                messageDiv.innerHTML = `
                    <div class="message-sender">${senderName}</div>
                    <div class="message-content">${message}</div>
                    <div class="message-time">${timeString}</div>
                `;
                
                return messageDiv;
            }

            // Zamanlayıcı bildirim konteynerini oluştur
            const notificationContainer = document.createElement('div');
            notificationContainer.className = 'notification-container';
            document.body.appendChild(notificationContainer);
            
            // Zamanlayıcı bildirimlerini gösterecek fonksiyon
            function showTimerNotification(message) {
                // Bildirim konteynerini kontrol et, yoksa oluştur
                let notificationContainer = document.querySelector('.notification-container');
                if (!notificationContainer) {
                    notificationContainer = document.createElement('div');
                    notificationContainer.className = 'notification-container';
                    document.body.appendChild(notificationContainer);
                }
                
                // Bildirim elementini oluştur
                const notification = document.createElement('div');
                notification.className = 'timer-notification';
                notification.textContent = message;
                
                // Koyu tema kontrolü
                if (document.body.classList.contains('dark-theme')) {
                    notification.style.backgroundColor = 'rgba(255, 255, 255, 0.15)';
                } else {
                    notification.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
                }
                
                // Konteynere ekle
                notificationContainer.appendChild(notification);
                
                // Doğru konumda olduğundan emin olmak için stilleri doğrudan uygula
                notificationContainer.style.position = 'fixed';
                notificationContainer.style.top = '20px';  // bottom yerine top kullanılıyor
                notificationContainer.style.right = '20px';
                notificationContainer.style.left = 'auto';
                notificationContainer.style.bottom = 'auto';  // bottom'ı otomatik yap
                notificationContainer.style.transform = 'none';
                notificationContainer.style.zIndex = '10001';
                notificationContainer.style.width = 'auto';
                notificationContainer.style.maxWidth = '350px';
                notificationContainer.style.display = 'flex';
                notificationContainer.style.flexDirection = 'column';
                notificationContainer.style.gap = '10px';
                notificationContainer.style.pointerEvents = 'none';
                
                // 5 saniye sonra bildirimi kaldır
                setTimeout(() => {
                    if (notification.parentNode === notificationContainer) {
                        notificationContainer.removeChild(notification);
                    }
                }, 5000);
            }
            
            // Orijinal butonların click event'lerini yakala
            startTimerBtn.addEventListener('click', function() {
                // Butonun mevcut metnine göre durumu belirle
                const isStarting = this.innerHTML.includes('fa-play');
                
                if (isStarting) {
                    showTimerNotification('Zamanlayıcı başlatıldı!');
                    this.innerHTML = '<i class="fas fa-pause"></i> Duraklat';
                } else {
                    showTimerNotification('Zamanlayıcı duraklatıldı!');
                    this.innerHTML = '<i class="fas fa-play"></i> Devam Et';
                }
                
                // Tam ekran modu açıksa, oradaki butonu da güncelle
                if (isFullscreen) {
                    const fullscreenStartBtn = document.getElementById('fullscreenStartBtn');
                    if (fullscreenStartBtn) {
                        fullscreenStartBtn.innerHTML = this.innerHTML;
                    }
                }
            });
            
            resetTimerBtn.addEventListener('click', function() {
                showTimerNotification('Zamanlayıcı sıfırlandı!');
                
                // Başlat butonunu ilk haline getir
                startTimerBtn.innerHTML = '<i class="fas fa-play"></i> Başlat';
                
                // Tam ekran modu açıksa, oradaki butonu da güncelle
                if (isFullscreen) {
                    const fullscreenStartBtn = document.getElementById('fullscreenStartBtn');
                    if (fullscreenStartBtn) {
                        fullscreenStartBtn.innerHTML = '<i class="fas fa-play"></i> Başlat';
                    }
                }
            });
        });
    </script>
</body>
</html> 